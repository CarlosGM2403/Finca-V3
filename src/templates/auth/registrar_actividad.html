{% extends 'base.html' %}

{% block title %}Registrar Actividad{% endblock %}

{% block CustomCSS %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/registrar_actividad.css') }}">
{% endblock %}

{% block body %}
<div class="logo">
    <img src="{{ url_for('static', filename='img/logo_icon.png') }}" alt="Logo">
</div>

<div class="actividad-container">
  <h1>¡Registrar Mi Actividad!</h1>

  <form method="POST" enctype="multipart/form-data">

    <!-- Fila de selects + imagen -->
    <div class="form-row">
      <div class="form-inputs">
        <!-- Tipo de actividad -->
        <label for="actividad" align="left">Tipo de actividad</label>
        <select name="actividad" id="actividad" required>
          <option value="cafe">Cosecha de Café</option>
          <option value="limon">Cosecha de Limón</option>
          <option value="mani">Cosecha de Maní</option>
          <option value="fumigacion">Fumigación</option>
        </select>

        <!-- Insumos -->
        <label for="insumos" align="left">Insumos utilizados</label>
        <select name="insumos" id="insumos" required>
          <option value="ninguno">Ninguno</option>
          <option value="fertilizante">Fertilizante</option>
          <option value="herbicida">Herbicida</option>
          <option value="semillas">Semillas</option>
        </select>
      </div>

      <!-- Imagen a la derecha -->
      <div class="form-image">
        <img src="{{ url_for('static', filename='img/agricultor.png') }}" alt="Actividad">
      </div>
    </div>

    <!-- Observaciones -->
    <label for="observaciones" align="left">Observaciones</label>
    <textarea name="observaciones" id="observaciones" rows="4" required></textarea>

    <!-- Tomar evidencia + botones -->
    <label for="evidencia" align="left">Tomar evidencia</label>
    <div class="acciones-evidencia">
      <!-- Botón cámara -->
      <div class="acciones-izquierda">
        <button type="button" id="cameraBtn" class="camera-btn">
          <i class="fas fa-camera"></i> Tomar foto
        </button>

        <!-- Botón Ver Fotos debajo -->
        <a href="{{ url_for('ver_fotos') }}" class="btn-fotos">Ver Fotos</a>
      </div>

      <!-- Bloque de botones a la derecha -->
      <div class="acciones-derecha">
        <button type="submit" class="btn-guardar">Guardar</button>
        <a href="{{ url_for('home') }}" class="btn-salir">Salir</a>
      </div>
    </div>

    <!-- Input oculto -->
    <input type="file" id="evidencia" name="evidencia"
           accept="image/*" capture="environment" style="display: none;">

    <!-- Vista previa de la imagen -->
    <div id="preview" class="preview"></div>

  </form>
</div>
    <div class="planta">
        <img src="{{ url_for('static', filename='img/plantaa.png') }}" alt="planta">
    </div>

<script>
  document.getElementById('cameraBtn').addEventListener('click', function() {
    document.getElementById('evidencia').click();
  });

  // Mostrar preview de la foto tomada
  document.getElementById('evidencia').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('preview').innerHTML = `<img src="${e.target.result}" alt="Foto tomada">`;
      };
      reader.readAsDataURL(file);
    }
  });
</script>
{% endblock %}
