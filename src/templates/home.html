{% extends 'base.html' %}
{% block title %}Home{% endblock %}

{% block CustomCSS %}
<!-- Iconos FontAwesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">


<!-- Estilos propios -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock %}

{% block scripts %}
<script>
  function toggleMenu() {
    document.getElementById("menu").classList.toggle("show");
  }

  // Cierra el menú si se hace clic fuera
  document.addEventListener("click", function(event) {
    const menu = document.getElementById("menu");
    const menuBtn = document.querySelector(".menu-btn");

    if (menu.classList.contains("show") && 
        !menu.contains(event.target) && 
        !menuBtn.contains(event.target)) {
      menu.classList.remove("show");
    }
  });

  function confirmLogout() {
    if (confirm("¿Seguro que quieres cerrar sesión?")) {
      window.location.href = "{{ url_for('logout') }}";  
    }
  }
</script>
{% endblock %}

{% block body %}
<!-- LOGO -->
<div class="logo">
  <img src="{{ url_for('static', filename='img/Logo_principal.png') }}" alt="Logo">
</div>


<!-- BOTÓN PERFIL -->
<div class="profile-btn">
  <a href="{{ url_for('perfil') }}">
    <img src="{{ url_for('static', filename='img/perfil.png') }}" 
         alt="Perfil" 
         class="profile-icon">
  </a>
</div>



<!-- BOTÓN LOGOUT -->
<div class="logout-btn">
  <button data-bs-toggle="modal" data-bs-target="#logoutModal">
    <i class="fa-solid fa-door-open"></i>
    <i class="fa-solid fa-arrow-right"></i>
  </button>
</div>

<!-- LOGOUT -->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-3 shadow-lg">
      <div class="modal-header">
        <h5 class="modal-title" id="logoutModalLabel">Cerrar Sesión</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        ¿Estás seguro de que quieres cerrar sesión?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <a href="{{ url_for('logout') }}" class="btn btn-danger">Sí, salir</a>
      </div>
    </div>
  </div>
</div>

<!-- BOTÓN MENÚ HAMBURGUESA -->
<button class="menu-btn" onclick="toggleMenu()">
  <span></span>
  <span></span>
  <span></span>
</button>

<!-- MENÚ LATERAL -->
<div class="menu" id="menu">
  {% if rol != 'administrador' %}
    <a href="{{ url_for('registrar_actividad') }}">Registrar Actividad</a>
  {% endif %}
  <a href="#">Problemas de cultivo</a>
  <a href="#">Solicitudes de Insumos</a>
  {% if rol != 'administrador' %}
    <a href="{{ url_for('registrar_siembra') }}">Registro de Siembra</a>
  {% endif %}

  <!-- Botones de abajo (solo visibles en móvil) -->
  <div class="menu-mobile">
    {# --- Usuarios / Registrar Actividad --- #}
    {% if rol == 'administrador' %}
      <a href="{{ url_for('usuarios') }}">Usuarios</a>
    {% else %}
      <a href="{{ url_for('registrar_actividad') }}">Registrar Actividad</a>
    {% endif %}

    {# --- Producción / Registro de Siembra --- #}
    {% if rol == 'administrador' or rol == 'supervisor' %}
      <a href="{{ url_for('en_construccion') }}">Producción</a>
    {% else %}
      <a href="{{ url_for('registrar_siembra') }}">Registro de Siembra</a>
    {% endif %}

    {# --- Ventas / Solicitud de Insumos --- #}
    {% if rol == 'administrador' %}
      <a href="{{ url_for('en_construccion') }}">Ventas</a>
    {% else %}
      <a href="{{ url_for('en_construccion') }}">Solicitar Insumos</a>
    {% endif %}

    {# --- Evidencias / Tratamientos --- #}
    {% if rol == 'administrador' %}
      <a href="{{ url_for('en_construccion') }}">Evidencias</a>
    {% else %}
      <a href="{{ url_for('en_construccion') }}">Tratamientos</a>
    {% endif %}
  </div>
</div>

<script>
  function toggleMenu() {
    document.getElementById("menu").classList.toggle("show");
  }

  //cerrar si se hace clic fuera del menú
  document.addEventListener("click", function(event) {
    const menu = document.getElementById("menu");
    const btn = document.querySelector(".menu-btn");

    if (!menu.contains(event.target) && !btn.contains(event.target)) {
      menu.classList.remove("show");
    }
  });
  </script>

<!-- GRUPOS DE BOTONES -->
<div class="grupo-izquierda">
  {# --- Botón Usuarios / Registrar Actividad --- #}
  {% if rol == 'administrador' %}
  <a href="{{ url_for('usuarios') }}">
    <button class="btn-normal">Usuarios</button>
  </a>
  {% else %}
  <a href="{{ url_for('registrar_actividad') }}">
    <button class="btn-normal">Registra Actividad</button>
  </a>
  {% endif %}
  {# --- Botón Producción / Registro de Siembra --- #}
  {% if rol == 'administrador' or rol == 'supervisor' %}
  <a href="{{ url_for('en_construccion') }}">
    <button class="btn-normal">Producción</button>
  </a>
  {% else %}
  <a href="{{ url_for('registrar_siembra') }}">
    <button class="btn-normal">Registra Siembra</button>
  </a>
  {% endif %}
</div>

<div class="btn-wrapper">
  <div class="circle circle1"></div>
  <div class="circle circle2"></div>
    <a href="{{ url_for('cultivos') }}" class="btn">Cultivos</a>
</div>

<div class="grupo-derecha">
  {# --- Botón Ventas / Solicitud de Insumos --- #}
{% if rol == 'administrador' %}
  <a href="{{ url_for('en_construccion') }}">
    <button class="btn-normal">Ventas</button>
  </a>
{% else %}
  <a href="{{ url_for('en_construccion') }}">
    <button class="btn-normal">Solicitar Insumos</button>
  </a>
{% endif %}
  {# --- Botón Evidencias / Tratamientos Aplicados --- #}
{% if rol == 'administrador' %}
  <a href="{{ url_for('en_construccion') }}">
    <button class="btn-normal">Evidencias</button>
  </a>
{% else %}
  <a href="{{ url_for('en_construccion') }}">
    <button class="btn-normal">Tratamientos</button>
  </a>
{% endif %}
</div>
{% endblock %}
